CREATE TABLE EMP (
  EMPNO NUMBER(4) NOT NULL,
  ENAME VARCHAR2(10),
  JOB VARCHAR2(9),
  MGR NUMBER(4),
  HIREDATE DATE,
  SAL NUMBER(7, 2),
  COMM NUMBER(7, 2),
  DEPTNO NUMBER(2)
);

INSERT INTO EMP VALUES (7369, 'SMITH', 'CLERK', 7902, TO_DATE('17-DEC-80', 'DD-MON-YY'), 800, 0, 20);
INSERT INTO EMP VALUES (7499, 'ALLEN', 'SALESMAN', 7698, TO_DATE('20-FEB-81', 'DD-MON-YY'), 1600, 300, 30);
INSERT INTO EMP VALUES (7521, 'WARD', 'SALESMAN', 7698, TO_DATE('22-FEB-81', 'DD-MON-YY'), 1250, 500, 30);
INSERT INTO EMP VALUES (7566, 'JONES', 'MANAGER', 7839, TO_DATE('02-APR-81', 'DD-MON-YY'), 2975, 0, 20);
INSERT INTO EMP VALUES (7654, 'MARTIN', 'SALESMAN', 7698, TO_DATE('28-SEP-81', 'DD-MON-YY'), 1250, 1400, 30);
INSERT INTO EMP VALUES (7698, 'BLAKE', 'MANAGER', 7839, TO_DATE('01-MAY-81', 'DD-MON-YY'), 2850, 0, 30);
INSERT INTO EMP VALUES (7782, 'CLERK', 'MANAGER', 7839, TO_DATE('09-JUN-81', 'DD-MON-YY'), 2450, 0, 10);
INSERT INTO EMP VALUES (7788, 'SCOTT', 'ANALYST', 7566, TO_DATE('19-APR-81', 'DD-MON-YY'), 3000, 0, 20);
INSERT INTO EMP VALUES (7839, 'KING', 'PRESIDENT', 0, TO_DATE('17-NOV-81', 'DD-MON-YY'), 5000, 0, 10);
INSERT INTO EMP VALUES (7844, 'TURNER', 'SALESMAN', 7698, TO_DATE('08-SEP-81', 'DD-MON-YY'), 1500, 0, 30);
INSERT INTO EMP VALUES (7876, 'ADAMS', 'CLERK', 7788, TO_DATE('23-MAY-87', 'DD-MON-YY'), 1100, NULL, 20);
INSERT INTO EMP VALUES (7900, 'JAMES', 'CLERK', 7698, TO_DATE('03-DEC-81', 'DD-MON-YY'), 950, NULL, 30);
INSERT INTO EMP VALUES (7902, 'FORD', 'ANALYST', 7566, TO_DATE('03-DEC-81', 'DD-MON-YY'), 3000, NULL, 20);
INSERT INTO EMP VALUES (7934, 'MILLER', 'CLERK', 7782, TO_DATE('12-JAN-82', 'DD-MON-YY'), 1300, NULL, 10);


CREATE TABLE DEPT (
  DEPTNO NUMBER(2) NOT NULL,
  DNAME VARCHAR2(14),
  LOC VARCHAR2(13)
);

INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO DEPT VALUES (20, 'RESEARCH', 'DALLAS');
INSERT INTO DEPT VALUES (30, 'SALES', 'CHICAGO');
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON');


CREATE TABLE PROGRAMMER (
  NAME VARCHAR2(8) PRIMARY KEY NOT NULL,
  DOB DATE NOT NULL,
  DOJ DATE NOT NULL,
  SEX VARCHAR2(1) NOT NULL,
  PROF1 VARCHAR2(8),
  PROF2 VARCHAR2(8),
  SALARY NUMBER(4) NOT NULL
);

INSERT INTO PROGRAMMER VALUES ('ANAND', TO_DATE('21-APR-66', 'DD-MON-YY'), TO_DATE('21-APR-92', 'DD-MON-YY'), 'M', 'PASCAL', 'BASIC', 3200);
INSERT INTO PROGRAMMER VALUES ('ALTAF', TO_DATE('02-JUL-64', 'DD-MON-YY'), TO_DATE('13-NOV-90', 'DD-MON-YY'), 'M', 'CLIPER', 'COBOL', 2800);
INSERT INTO PROGRAMMER VALUES ('JAGDESH', TO_DATE('06-OCT-70', 'DD-MON-YY'), TO_DATE('04-OCT-94', 'DD-MON-YY'), 'M', 'ORACLE', 'JAVA', 4100);
INSERT INTO PROGRAMMER VALUES ('JULIANA', TO_DATE('31-JAN-68', 'DD-MON-YY'), TO_DATE('21-APR-90', 'DD-MON-YY'), 'F', 'COBOL', 'DBASE', 3000);
INSERT INTO PROGRAMMER VALUES ('KAMALA', TO_DATE('30-OCT-68', 'DD-MON-YY'), TO_DATE('02-JAN-92', 'DD-MON-YY'), 'F', 'C', 'DBASE', 2900);
INSERT INTO PROGRAMMER VALUES ('MARY', TO_DATE('24-JUN-70', 'DD-MON-YY'), TO_DATE('01-FEB-91', 'DD-MON-YY'), 'F', 'C++', 'ORACLE', 4500);
INSERT INTO PROGRAMMER VALUES ('PATRIK', TO_DATE('19-NOV-65', 'DD-MON-YY'), TO_DATE('21-APR-90', 'DD-MON-YY'), 'M', 'PASCAL', 'CLIPER', 2800);
INSERT INTO PROGRAMMER VALUES ('QADIR', TO_DATE('31-AUG-85', 'DD-MON-YY'), TO_DATE('21-APR-93', 'DD-MON-YY'), 'M', 'ASSEMBLY', 'C', 3000);
INSERT INTO PROGRAMMER VALUES ('RAMESH', TO_DATE('03-MAY-67', 'DD-MON-YY'), TO_DATE('28-FEB-91', 'DD-MON-YY'), 'M', 'PASCAL', 'DBASE', 3200);
INSERT INTO PROGRAMMER VALUES ('REBECCA', TO_DATE('01-JAN-67', 'DD-MON-YY'), TO_DATE('01-DEC-90', 'DD-MON-YY'), 'F', 'BASIC', 'COBOL', 2500);
INSERT INTO PROGRAMMER VALUES ('REMITHA', TO_DATE('19-APR-70', 'DD-MON-YY'), TO_DATE('20-APR-93', 'DD-MON-YY'), 'F', 'C', 'ASSEMBLY', 3600);
INSERT INTO PROGRAMMER VALUES ('REVATHI', TO_DATE('02-DEC-69', 'DD-MON-YY'), TO_DATE('02-JAN-92', 'DD-MON-YY'), 'F', 'PASCAL', 'BESIC', 3700);
INSERT INTO PROGRAMMER VALUES ('VIJAYA', TO_DATE('14-DEC-65', 'DD-MON-YY'), TO_DATE('02-MAY-92', 'DD-MON-YY'), 'F', 'FOXPRO', 'C', 3500);
INSERT INTO PROGRAMMER VALUES ('NELSON', TO_DATE('11-SEP-65', 'DD-MON-YY'), TO_DATE('11-OCT-89', 'DD-MON-YY'), 'M', 'COBOL', 'DBASE', 2500);


CREATE TABLE SOFTWARE (
  NAME VARCHAR2(8) NOT NULL,
  TITLE VARCHAR2(20) NOT NULL,
  DEV_IN VARCHAR2(8) NOT NULL,
  SCOST NUMBER(7, 2),
  DCOST NUMBER(5),
  SOLD NUMBER(3)
);

INSERT INTO SOFTWARE VALUES ('ANAND', 'PARACHUTES', 'BASIC', 399.95, 6000, 43);
INSERT INTO SOFTWARE VALUES ('ANAND', 'VIDEO TITILING PACK', 'PASCAL', 7500, 16000, 9);
INSERT INTO SOFTWARE VALUES ('JAGDESH', 'SERIAL LINK UTILITY', 'JAVA', 800, 7500, 10);
INSERT INTO SOFTWARE VALUES ('JAGDESH', 'SHARES MANAGEMENT', 'ORACLE', 3000, 12000, 14);
INSERT INTO SOFTWARE VALUES ('JULIANA', 'INVENTORY CONTROL', 'COBOL', 3000, 3500, 0);
INSERT INTO SOFTWARE VALUES ('KAMALA', 'PAYROLL PACKAGE', 'DBASE', 9000, 20000, 7);
INSERT INTO SOFTWARE VALUES ('MARY', 'FINANCIAL ACCS/W', 'ORACLE', 18000, 85000, 4);
INSERT INTO SOFTWARE VALUES ('MARY', 'CODE GENERATOR', 'C', 4500, 20000, 23);
INSERT INTO SOFTWARE VALUES ('MARY', 'READ ME', 'C++', 300, 1200, 84);
INSERT INTO SOFTWARE VALUES ('PATRIC', 'GRAPHIC EDITOR', 'PASCAL', 750, 5000, 11);
INSERT INTO SOFTWARE VALUES ('QADIR', 'VACCINES', 'C', 1900, 3400, 21);
INSERT INTO SOFTWARE VALUES ('REMITHA', 'TSR HELP PACKAGE', 'ASSEMBLY', 2500, 6000, 6);
INSERT INTO SOFTWARE VALUES ('REVATHI', 'HOTEL MANAGEMENT', 'PASCAL', 1100, 75000, 2);
INSERT INTO SOFTWARE VALUES ('REVATHI', 'QUIZ MASTER', 'BASIC', 3200, 2100, 15);
INSERT INTO SOFTWARE VALUES ('VIJAYA', 'ISK EDITOR', 'C', 900, 700, 6);
INSERT INTO SOFTWARE VALUES ('QADIR', 'BOMBS AWAY', 'ASSEMBLY', 499.95, 530, 114);
INSERT INTO SOFTWARE VALUES ('RAMESH', 'HOTEL MANAGEMENT', 'DBASE', 12000, 35000, 4);
INSERT INTO SOFTWARE VALUES ('RAMESH', 'DEAD LEE', 'PASCAL', 99.95, 4500, 73);
INSERT INTO SOFTWARE VALUES ('REMITHA', 'PC UTILITIES', 'C', 725, 5000, 51);


CREATE TABLE STUDIES (
  NAME VARCHAR2(8) NOT NULL,
  SPLACE VARCHAR2(9) NOT NULL,
  COURSE VARCHAR2(5),
  COST NUMBER(5)
);

INSERT INTO STUDIES VALUES ('ANAND', 'SABHARI', 'PGDCA', 4500);
INSERT INTO STUDIES VALUES ('ALTAF', 'CCIT', 'DCA', 7200);
INSERT INTO STUDIES VALUES ('JAGDESH', 'S.S.I.L', 'DCA', 3500);
INSERT INTO STUDIES VALUES ('JULIANA', 'BITS', 'DCA', 22000);
INSERT INTO STUDIES VALUES ('KAMALA', 'PARAGATHI', 'DCP', 5000);
INSERT INTO STUDIES VALUES ('MARY', 'SABHARI', 'PGDCA', 4500);
INSERT INTO STUDIES VALUES ('NELSON', 'PARAGATHI', 'DCP', 6200);
INSERT INTO STUDIES VALUES ('PATRIC', 'PARAGATHI', 'DCAP', 5200);
INSERT INTO STUDIES VALUES ('QADIR', 'APPLE', 'HDCP', 14000);
INSERT INTO STUDIES VALUES ('RAMESH', 'SABHARI', 'PGDCA', 4500);
INSERT INTO STUDIES VALUES ('REBECCA', 'BRILLIANT', 'DCAP', 11000);
INSERT INTO STUDIES VALUES ('REMITHA', 'BDPS', 'DCS', 6000);
INSERT INTO STUDIES VALUES ('REVATHI', 'SABHARI', 'DAP', 5000);
INSERT INTO STUDIES VALUES ('VIJAYA', 'BDPS', 'DCA', 48000);


--1) display all info of specific programmer
DECLARE
  N PROGRAMMER.NAME%TYPE := '&N';
  INFO PROGRAMMER%ROWTYPE;
BEGIN
  SELECT * INTO INFO FROM PROGRAMMER WHERE NAME = N;
  DBMS_OUTPUT.PUT_LINE(INFO.NAME || ' ' || INFO.DOB || ' ' || INFO.DOJ || ' ' || INFO.SEX || ' ' || INFO.PROF1 || ' ' || INFO.PROF2 || ' ' || INFO.SALARY);
END;
/


--2)Display programmer who know language specified by user
DECLARE
  N PROGRAMMER.NAME%TYPE;
  LANG PROGRAMMER.PROF1%TYPE := '&LANG';
  CURSOR C1 IS 
    SELECT NAME FROM PROGRAMMER WHERE PROF1 = LANG;
BEGIN
  OPEN C1;
  LOOP
    FETCH C1 INTO N; 
    EXIT WHEN (C1%NOTFOUND);
    DBMS_OUTPUT.PUT_LINE(N);
  END LOOP;
  CLOSE C1;
END;
/

--3)display employee detail by emp no and only show name, salary and dept name
DECLARE
  ENO EMP.EMPNO%TYPE := '&ENO';
  NAME EMP.ENAME%TYPE;
  SALARY EMP.SAL%TYPE;
  DEPTNAME DEPT.DNAME%TYPE;
BEGIN 
  SELECT E.EMPNO, E.ENAME, E.SAL, D.DNAME 
  INTO ENO, NAME, SALARY, DEPTNAME 
  FROM EMP E, DEPT D 
  WHERE E.EMPNO = ENO AND E.DEPTNO = D.DEPTNO;
  DBMS_OUTPUT.PUT_LINE(ENO || ' ' || NAME || ' ' || SALARY || ' ' || DEPTNAME);
END;
/
